Some additions to the rest of the code.
